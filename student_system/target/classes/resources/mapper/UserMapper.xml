<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lb.mapper.UserMapper">
    <resultMap id="user" type="com.lb.entity.User">
        <id column="id" property="id"/>
        <result column="username" property="username"/>
        <result column="password" property="password"/>
        <result column="name" property="name"/>
        <result column="age" property="age"/>
        <result column="sex" property="sex"/>
        <result column="birthday" property="birthday"/>
        <result column="address" property="address"/>
        <result column="phone" property="phone"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="status" property="status"/>
        <result column="relationship" property="relationship"/>
    </resultMap>
    <!--sql片段-->
    <sql id="User_List">
		id,username,password,name,age,sex,birthday,address,phone,create_time,status,relationship
	</sql>
    <!--登录信息查询-->
    <select id="loginByUsername" parameterType="java.lang.String" resultMap="user">
		select*from
		user u
		inner join t_user_role t on u.id=user_id
		inner join role r on t.role_id=r.id
		where username=#{username};
	</select>

    <select id="queryStudentByClassName" parameterType="java.lang.String" resultMap="user">
		SELECT u.id,u.name,u.age,u.sex,u.birthday,u.address,u.phone
		from user u LEFT JOIN t_stu_class sc on u.id=sc.student_id
                    LEFT JOIN student_class c on c.id=sc.class_id
                    where c.class_name=#{className} and u.relationship=3 and u.status=1
	</select>

</mapper>
