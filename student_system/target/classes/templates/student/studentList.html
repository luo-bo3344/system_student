<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<meta name="viewport"
		  content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
	<title>学生-学生信息管理</title>
	<link rel="icon" href="favicon.ico" type="image/ico">
	<meta name="keywords" content="LightYear,光年,后台模板,后台管理系统,光年HTML模板">
	<meta name="description" content="LightYear是一个基于Bootstrap v3.3.7的后台管理系统的HTML模板。">
	<meta name="author" content="yinqi">
	<link href="../static/css/bootstrap.min.css" th:href="@{~/static/css/bootstrap.min.css}"
		  rel="stylesheet">
	<link href="../static/css/materialdesignicons.min.css"
		  th:href="@{~/static/css/materialdesignicons.min.css}" rel="stylesheet">
	<link href="../static/css/style.min.css" th:href="@{~/static/css/style.min.css}"
		  rel="stylesheet">
</head>

<body>
<div class="lyear-layout-web">
	<div class="lyear-layout-container">
		<div th:replace="common/commons :: commonMenu(2)">
		</div>
		<main class="lyear-layout-content">
			<div class="container-fluid">
				<div class="row">
					<div class="col-lg-12">
						<div class="card">
							<div class="card-toolbar clearfix">
								<form th:action="@{/student/queryStudent}" method="post" onsubmit="return checkStudentInput()">
									<div class="col-lg-3 pull-right">
										<div class="input-group">
											<input type="text" class="form-control" id="studentName" name="studentName"
												   placeholder="请输入学生名字...">
											<span class="input-group-btn">
										    <button class="btn btn-brown" type="submit" >搜索</button>
                                            </span>
										</div>
									</div>
								</form>
								<div class="toolbar-btn-action">
									<a class="btn btn-primary m-r-5"
									   th:href="@{/student/addStudent}"><i class="mdi mdi-plus"></i>添加学生</a>
									<button class="btn btn-purple mdi mdi-delete" id="delBatch" type="submit" th:onclick="|delBatch()|">批量删除
									</button>
								</div>
							</div>
							<div class="card-body">

								<div class="table-responsive">
									<table class="table table-bordered">
										<thead>
										<tr>
											<th>
												<label class="lyear-checkbox checkbox-primary">
													<input type="checkbox"
														   id="check-all"><span></span>
												</label>
											</th>
											<th>编号</th>
											<th>用户名</th>
											<th>密码</th>
											<th>学生姓名</th>
											<th>年龄</th>
											<th>性别</th>
											<th>出生日期</th>
											<th>家庭住址</th>
											<th>家长联系电话</th>
											<th>信息创建时间</th>
											<th>信息修改时间</th>
											<th>操作</th>
										</tr>
										</thead>
										<tbody>

										<tr th:each="one ,number: ${pageInfo.getList()}">
											<td>
												<label class="lyear-checkbox checkbox-primary">
													<input type="checkbox" class="itemBox" id="checkIds" name="ids[]"
														   th:value="#{one.id}"><span></span>
												</label>
											</td>
											<td th:text="${number.count}"></td>
											<td style="display:none" th:text="#{one.id}"></td>
											<td th:text="${one.username}"></td>
											<td th:type="password" th:text="${one.password}"></td>
											<td th:text="${one.name}"></td>
											<td th:text="${one.age}"></td>
											<td th:text="${one.sex}"></td>
											<td th:text="${#dates.format(one.birthday, 'yyyy-MM-dd')}"></td>
											<td style="overflow: hidden;text-overflow: ellipsis" th:text="${one.address}"></td>
											<td th:text="${one.phone}"></td>
											<td th:text="${#dates.format(one.createTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
											<td th:text="${#dates.format(one.updateTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
											<td>
												<a class="btn btn-xs btn-default" href="#!"
												   th:href="@{'/student/update/'+${one.id}}"><i
														class="mdi mdi-table-edit" style="color: limegreen">编辑</i></a>
												<a class="btn btn-xs btn-default"
												   href="javascript:void(0)"
												   th:onclick="|del(${one.id})|">
													<i class="mdi mdi-delete" style="color: red">删除</i></a>
											</td>
										</tr>
										</tbody>
									</table>
								</div>

								<div class="">
									<div>
										<span> 当前第[[${pageInfo.pageNum}]]页,共 [[${pageInfo.getPages()}]]页,一共[[${pageInfo.getTotal()}]]条记录</span>
									</div>
									<nav>
										<ul class="pagination">
											<li th:if="${pageInfo.isHasPreviousPage()}">
												<a th:href="'/student/studentList?pageNum=1'">首页</a>
											</li>
											<li class="prev" th:if="${pageInfo.isHasPreviousPage()}">
												<a th:href="'/student/studentList?pageNum='+${pageInfo.getPrePage()}">
													<i class="mdi mdi-chevron-left" style="color:#2ba3f6">pre</i>
												</a>
											</li>
											<!-- 遍历条数-->
											<li th:each="nav:${pageInfo.getNavigatepageNums()}">
												<a th:href="'/student/studentList?pageNum='+${nav}"
												   th:text="${nav}"
												   th:if="${nav != pageInfo.getPageNum()}"></a>
												<span style="font-weight: bold;background:mediumseagreen;"
													  th:if="${nav == pageInfo.getPageNum()}"
													  th:text="${nav}"></span>
											</li>
											<li class="next" th:if="${pageInfo.isHasNextPage()}">
												<a th:href="'/student/studentList?pageNum='+${pageInfo.getNextPage()}">
													<i class="mdi mdi-chevron-right" style="color:#2ba3f6">next</i>
												</a>
											</li>
											<li>
												<a th:href="'/student/studentList?pageNum='+${pageInfo.getPages()}">尾页</a>
											</li>
										</ul>
									</nav>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
		<!--End 页面主要内容-->
	</div>
</div>

<script type="text/javascript" src="js/jquery.min.js"
		th:src="@{~/static/js/jquery.min.js}"></script>
<script type="text/javascript" src="js/bootstrap.min.js"
		th:src="@{~/static/js/bootstrap.min.js}"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"
		th:src="@{~/static/js/perfect-scrollbar.min.js}"></script>
<script type="text/javascript" src="js/main.min.js" th:src="@{~/static/js/main.min.js}"></script>
<script type="text/javascript" th:src="@{~/static/js/jquery-3.1.1.js}"></script>
<script>
    //搜索判断是否为空
    function checkStudentInput() {
        //var studentName=$("studentName").val();
        var studentName = document.getElementById("studentName").value;
        console.log(studentName);
        if (studentName === null || studentName === "") {
            alert("输入学生名字不能为空！");
            return false;
        }
    }

    //删除学生信息
    function del(id) {
        var sure = confirm("确定删除该条学生信息吗?");
        if (sure) {
            $.ajax({
                url: "[[@{/student/delete/}]]" + id,
                data: {"id": id},
                type: "GET",
                success: function (data) {
                    console.log(data)
                    if (data === "删除成功") {
                        window.location.reload();
                        alert("删除成功");
                    }
                }
            });
        }
    }


    /*function delBatch(){
        var ids="";
        $("#checkIds:checked").each(function (index, element) {
            //拼接字符串，将这些要删除的id拼接起来，使用，分割
            ids += $(element).val() + ",";
        });
        console.log("test="+ids)
        ids = ids.substring(0, ids.length - 1);
        console.log("hahahahha"+ids)
        $.ajax({
            url: "[[@{/student/batchDelete}]]",
            data: {"ids": ids},
            type: "post",
            dataType: "json",
            success: function (data) {
                console.log(data)
                if (data === "删除成功") {
                    window.location.reload();
                    alert("删除成功");
                }
            }
		})
	}*/
    $(function () {
        $('.search-bar .dropdown-menu a').click(function () {
            var field = $(this).data('field') || '';
            $('#search-field').val(field);
            $('#search-btn').html($(this).text() + ' <span class="caret"></span>');
        });
    });


</script>
</body>
</html>